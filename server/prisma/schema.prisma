// ===== PRISMA CONFIG =====
generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")   // üëà agrega esto

}


// ============== MODELOS ==============

model Sala {
  id        Int      @id @default(autoincrement())
  codigo    String   @unique
  anfitrion String // ‚¨ÖÔ∏è NUEVO: lo usas en POST /salas
  creadaEn  DateTime @default(now())

  // LADO OPUESTO de Equipo.sala
  equipos Equipo[] @relation("SalaEquipos")

  @@map("salas")
}

model Equipo {
  id     Int    @id @default(autoincrement())
  nombre String @map("nombre")

  // FK a Sala
  salaId Int  @map("sala_id")
  sala   Sala @relation("SalaEquipos", fields: [salaId], references: [id])

  // relaci√≥n con Integrantes
  integrantes Integrante[] @relation("EquipoIntegrantes")

  // ‚¨ÖÔ∏è √önico compuesto para permitir where: { salaId_nombre: { ... } }
  @@unique([salaId, nombre], name: "salaId_nombre")
  @@map("equipos")
}

model Integrante {
  id      Int     @id @default(autoincrement())
  nombre  String
  carrera String? @map("carrera") // ‚¨ÖÔ∏è NUEVO: opcional, lo env√≠as en /unirse

  // FK a Equipo
  equipoId Int    @map("equipo_id")
  equipo   Equipo @relation("EquipoIntegrantes", fields: [equipoId], references: [id])

  @@map("integrantes")
}
